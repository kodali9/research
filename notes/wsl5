WSL
---

# 0) Ensure we're in WSL (Ubuntu shell). If VS Code can't open it, open "Ubuntu" app directly.

# 1) Unlock and clean up resolv.conf
sudo chattr -i /etc/resolv.conf 2>/dev/null || true
sudo rm -f /etc/resolv.conf

# 2) Use the Windows host (WSL gateway) as DNS, with a safe fallback
GATEWAY_IP=$(ip route | awk '/^default/ {print $3; exit}')
printf "nameserver %s\nnameserver 1.1.1.1\n" "$GATEWAY_IP" | sudo tee /etc/resolv.conf >/dev/null

# 3) Ensure no Windows CRLF sneaks in (just in case the file was edited on Windows)
sudo sed -i 's/\r$//' /etc/resolv.conf

# 4) Lock it so WSL won’t overwrite
sudo chattr +i /etc/resolv.conf

# 5) (Optional) Clear VS Code's WSL server so it reconnects clean
rm -rf ~/.vscode-server ~/.vscode-remote 2>/dev/null || true

++++++
In /etc/wsl.conf (inside WSL), ensure:
-----
[network]
generateResolvConf = false

+++++++
In %UserProfile%\.wslconfig (Windows), it’s fine to keep:
--------
[wsl2]
generateResolvConf = false

+++++++++
Then run on Windows
----
wsl --shutdown

+++++++++
Quick tests (run in WSL)
----
getent hosts api.github.com
getent hosts your-eks-endpoint.amazonaws.com   # paste your cluster server from kubeconfig
kubectl cluster-info

